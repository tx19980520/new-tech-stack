# jar warm up详解

测试环境——4核&8G

## jar 运行时状态

在《SRE Google运维解密》中提到，在过载的时候我们遇到启用更多Pod来承受压力，但是因为jar在执行过程中就已经存在相应的状态，包括内存使用量，JIT动态编译进入编译态，GC方式与阈值。但是我们在刚启动一个pod的时候，我们的Pod中并不存在这样的状态，这会给我们的ops相应的错觉——新启动的Pod与持续运行一段时间之后的Pod的性能是相同的，但实际的情况是，新启动的Pod并没有相应的性能。本节中，我们将针对启动时间和运行时性能，面向内存初始值、执行模式、GC模式进行测试。

### 内存初始值

内存初始值，主要影响的是面对突如其来的请求，allocate memory会存在大量的性能消耗；同时，对于启动jar包，可能会导致启动时间较长。

### 执行模式

执行模式主要是解释执行或编译执行两种方式。更重要的是，在执行过程中，随着调用次数的提升，会从解释执行的模式切换到编译执行，并且是按照代码块（api method）进行计数和编译（并非整体编译）。

首先先观察最极端的两种情况，完全不编译和完全编译

| 测试领域         | 编译执行 | 解释执行 |
| ---------------- | -------- | -------- |
| jar包启动        | 24.523s  | 4.594s   |
| 相关接口压力测试 |          |          |



### GC模式

GC的模式主要会影响到的内存和CPU的使用，会造成在一段时间内，service的性能极差，资源被用以GC。

